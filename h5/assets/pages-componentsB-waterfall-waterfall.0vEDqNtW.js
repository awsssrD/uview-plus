import{_ as t}from"./up-lazy-load.Bo25rJyS.js";import{m as e,k as i,o as s,c as a,w as l,a as o,u as r,i as u,G as p,A as d,r as h,b as m,d as n,F as c,f,t as g,g as w}from"./index-C3UXxwfW.js";import{r as L}from"./uni-app.es.CqYlZVXb.js";import{_ as y}from"./up-icon.BrIVCe5a.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as v}from"./up-loadmore.DOsK9kKM.js";import"./up-line.BBfW2jaO.js";import"./up-loading-icon.DXCjh8Fn.js";const x=_({name:"up-waterfall",props:{modelValue:{type:Array,required:!0,default:function(){return[]}},addTime:{type:[Number,String],default:200},idKey:{type:String,default:"id"}},mixins:[e,i],data:()=>({leftList:[],rightList:[],tempList:[],children:[]}),watch:{copyFlowList(t,e){let i=Array.isArray(e)&&e.length>0?e.length:0;this.tempList=this.tempList.concat(this.cloneData(t.slice(i))),this.splitData()}},mounted(){this.tempList=this.cloneData(this.copyFlowList),this.splitData()},computed:{copyFlowList(){return this.cloneData(this.modelValue)}},emits:["update:modelValue"],methods:{async splitData(){if(!this.tempList.length)return;let t=await this.$uGetRect("#up-left-column"),e=await this.$uGetRect("#up-right-column"),i=this.tempList[0];i&&(t.height<e.height?this.leftList.push(i):t.height>e.height?this.rightList.push(i):this.leftList.length<=this.rightList.length?this.leftList.push(i):this.rightList.push(i),this.tempList.splice(0,1),this.tempList.length&&setTimeout((()=>{this.splitData()}),this.addTime))},cloneData:t=>JSON.parse(JSON.stringify(t)),clear(){this.leftList=[],this.rightList=[],this.$emit("update:modelValue",[]),this.tempList=[]},remove(t){let e=-1;e=this.leftList.findIndex((e=>e[this.idKey]==t)),-1!=e?this.leftList.splice(e,1):(e=this.rightList.findIndex((e=>e[this.idKey]==t)),-1!=e&&this.rightList.splice(e,1)),e=this.modelValue.findIndex((e=>e[this.idKey]==t)),-1!=e&&this.$emit("update:modelValue",this.modelValue.splice(e,1))},modify(t,e,i){let s=-1;if(s=this.leftList.findIndex((e=>e[this.idKey]==t)),-1!=s?this.leftList[s][e]=i:(s=this.rightList.findIndex((e=>e[this.idKey]==t)),-1!=s&&(this.rightList[s][e]=i)),s=this.modelValue.findIndex((e=>e[this.idKey]==t)),-1!=s){let t=this.cloneData(this.modelValue);t[s][e]=i,this.$emit("update:modelValue",t)}}}},[["render",function(t,e,i,p,d,h){const m=u;return s(),a(m,{class:"up-waterfall"},{default:l((()=>[o(m,{ref:"up-left-column",id:"up-left-column",class:"up-column"},{default:l((()=>[r(t.$slots,"left",{leftList:d.leftList},void 0,!0)])),_:3},512),o(m,{ref:"up-right-column",id:"up-right-column",class:"up-column"},{default:l((()=>[r(t.$slots,"right",{rightList:d.rightList},void 0,!0)])),_:3},512)])),_:3})}],["__scopeId","data-v-7836946b"]]);const j=_({data:()=>({loadStatus:"loadmore",flowList:[],list:[{price:35,title:"北国风光，千里冰封，万里雪飘",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper1.png"},{price:75,title:"望长城内外，惟余莽莽",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper2.png"},{price:385,title:"大河上下，顿失滔滔",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper3.png"},{price:784,title:"欲与天公试比高",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper1.png"},{price:7891,title:"须晴日，看红装素裹，分外妖娆",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper2.png"},{price:2341,shop:"李白杜甫白居易旗舰店",title:"江山如此多娇，引无数英雄竞折腰",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper3.png"},{price:661,shop:"李白杜甫白居易旗舰店",title:"惜秦皇汉武，略输文采",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper1.png"},{price:1654,title:"唐宗宋祖，稍逊风骚",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper2.png"},{price:1678,title:"一代天骄，成吉思汗",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper3.png"},{price:924,title:"只识弯弓射大雕",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper1.png"},{price:8243,title:"俱往矣，数风流人物，还看今朝",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper2.png"}]}),onLoad(){this.addRandomData()},onReachBottom(){this.loadStatus="loading",setTimeout((()=>{this.addRandomData(),this.loadStatus="loadmore"}),1e3)},methods:{addRandomData(){for(let t=0;t<10;t++){let t=p(0,this.list.length-1),e=JSON.parse(JSON.stringify(this.list[t]));e.id=d(),this.flowList.push(e)}},remove(t){this.$refs.uWaterfallRef.remove(t)},clear(){this.$refs.uWaterfallRef.clear()}}},[["render",function(e,i,r,p,d,_){const j=L(h("up-lazy-load"),t),D=u,V=w,R=L(h("up-icon"),y),S=L(h("up-waterfall"),x),$=L(h("up-loadmore"),v);return s(),a(D,{class:"wrap"},{default:l((()=>[o(S,{modelValue:d.flowList,"onUpdate:modelValue":i[0]||(i[0]=t=>d.flowList=t),ref:"uWaterfallRef"},{left:l((({leftList:t})=>[(s(!0),m(c,null,n(t,((t,e)=>(s(),a(D,{class:"demo-warter",key:e},{default:l((()=>[o(j,{threshold:"-450",height:"120","border-radius":"10",image:t.image,index:e},null,8,["image","index"]),o(D,{class:"demo-title"},{default:l((()=>[f(g(t.title),1)])),_:2},1024),o(D,{class:"demo-price"},{default:l((()=>[f(g(t.price)+"元",1)])),_:2},1024),o(D,{class:"demo-tag"},{default:l((()=>[o(D,{class:"demo-tag-owner"},{default:l((()=>[o(V,{class:"text"},{default:l((()=>[f("自营")])),_:1})])),_:1}),o(D,{class:"demo-tag-text"},{default:l((()=>[o(V,{class:"text"},{default:l((()=>[f("放心购")])),_:1})])),_:1})])),_:1}),o(D,{class:"demo-shop"},{default:l((()=>[f(g(t.shop),1)])),_:2},1024),o(D,{class:"u-close"},{default:l((()=>[o(R,{name:"close-circle-fill",color:"#fa3534",size:"16",onClick:e=>_.remove(t.id)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),right:l((({rightList:t})=>[(s(!0),m(c,null,n(t,((t,e)=>(s(),a(D,{class:"demo-warter",key:e},{default:l((()=>[o(j,{threshold:"-450",height:"120","border-radius":"10",image:t.image,index:e},null,8,["image","index"]),o(D,{class:"demo-title"},{default:l((()=>[f(g(t.title),1)])),_:2},1024),o(D,{class:"demo-price"},{default:l((()=>[f(g(t.price)+"元",1)])),_:2},1024),o(D,{class:"demo-tag"},{default:l((()=>[o(D,{class:"demo-tag-owner"},{default:l((()=>[o(V,{class:"text"},{default:l((()=>[f("自营")])),_:1})])),_:1}),o(D,{class:"demo-tag-text"},{default:l((()=>[o(V,{class:"text"},{default:l((()=>[f("放心购")])),_:1})])),_:1})])),_:1}),o(D,{class:"demo-shop"},{default:l((()=>[f(g(t.shop),1)])),_:2},1024),o(D,{class:"u-close"},{default:l((()=>[o(R,{name:"close-circle-fill",color:"#fa3534",size:"34",onClick:e=>_.remove(t.id)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modelValue"]),o($,{"bg-color":"rgb(240, 240, 240)",status:d.loadStatus,onLoadmore:_.addRandomData},null,8,["status","onLoadmore"])])),_:1})}],["__scopeId","data-v-0255eae0"]]);export{j as default};
