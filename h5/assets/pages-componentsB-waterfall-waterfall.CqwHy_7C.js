import{_ as t}from"./u-lazy-load.BThTvZWK.js";import{o as e,c as i,w as s,a,h as l,i as o,H as r,B as u,r as p,b as d,d as h,F as m,j as n,t as c}from"./index-CVTFhuPC.js";import{r as g}from"./uni-app.es.CSmlzn3X.js";import{_ as f}from"./u-icon.Hgib9abg.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as L}from"./u-loadmore.Bsp74N-Z.js";import"./u-line.BlFLInzE.js";import"./u-loading-icon.bY6XNa_p.js";const y=w({name:"u-waterfall",props:{modelValue:{type:Array,required:!0,default:function(){return[]}},addTime:{type:[Number,String],default:200},idKey:{type:String,default:"id"}},data:()=>({leftList:[],rightList:[],tempList:[],children:[]}),watch:{copyFlowList(t,e){let i=Array.isArray(e)&&e.length>0?e.length:0;this.tempList=this.tempList.concat(this.cloneData(t.slice(i))),this.splitData()}},mounted(){this.tempList=this.cloneData(this.copyFlowList),this.splitData()},computed:{copyFlowList(){return this.cloneData(this.modelValue)}},emits:["update:modelValue"],methods:{async splitData(){if(!this.tempList.length)return;let t=await this.$uGetRect("#u-left-column"),e=await this.$uGetRect("#u-right-column"),i=this.tempList[0];i&&(t.height<e.height?this.leftList.push(i):t.height>e.height?this.rightList.push(i):this.leftList.length<=this.rightList.length?this.leftList.push(i):this.rightList.push(i),this.tempList.splice(0,1),this.tempList.length&&setTimeout((()=>{this.splitData()}),this.addTime))},cloneData:t=>JSON.parse(JSON.stringify(t)),clear(){this.leftList=[],this.rightList=[],this.$emit("update:modelValue",[]),this.tempList=[]},remove(t){let e=-1;e=this.leftList.findIndex((e=>e[this.idKey]==t)),-1!=e?this.leftList.splice(e,1):(e=this.rightList.findIndex((e=>e[this.idKey]==t)),-1!=e&&this.rightList.splice(e,1)),e=this.modelValue.findIndex((e=>e[this.idKey]==t)),-1!=e&&this.$emit("input",this.modelValue.splice(e,1))},modify(t,e,i){let s=-1;if(s=this.leftList.findIndex((e=>e[this.idKey]==t)),-1!=s?this.leftList[s][e]=i:(s=this.rightList.findIndex((e=>e[this.idKey]==t)),-1!=s&&(this.rightList[s][e]=i)),s=this.modelValue.findIndex((e=>e[this.idKey]==t)),-1!=s){let t=this.cloneData(this.modelValue);t[s][e]=i,this.$emit("update:modelValue",t)}}}},[["render",function(t,r,u,p,d,h){const m=o;return e(),i(m,{class:"u-waterfall"},{default:s((()=>[a(m,{id:"u-left-column",class:"u-column"},{default:s((()=>[l(t.$slots,"left",{leftList:d.leftList},void 0,!0)])),_:3}),a(m,{id:"u-right-column",class:"u-column"},{default:s((()=>[l(t.$slots,"right",{rightList:d.rightList},void 0,!0)])),_:3})])),_:3})}],["__scopeId","data-v-3c0358ac"]]);const v=w({data:()=>({loadStatus:"loadmore",flowList:[],list:[{price:35,title:"北国风光，千里冰封，万里雪飘",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper1.png"},{price:75,title:"望长城内外，惟余莽莽",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper2.png"},{price:385,title:"大河上下，顿失滔滔",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper3.png"},{price:784,title:"欲与天公试比高",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper1.png"},{price:7891,title:"须晴日，看红装素裹，分外妖娆",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper2.png"},{price:2341,shop:"李白杜甫白居易旗舰店",title:"江山如此多娇，引无数英雄竞折腰",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper3.png"},{price:661,shop:"李白杜甫白居易旗舰店",title:"惜秦皇汉武，略输文采",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper1.png"},{price:1654,title:"唐宗宋祖，稍逊风骚",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper2.png"},{price:1678,title:"一代天骄，成吉思汗",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper3.png"},{price:924,title:"只识弯弓射大雕",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper1.png"},{price:8243,title:"俱往矣，数风流人物，还看今朝",shop:"李白杜甫白居易旗舰店",image:"https://uview-plus.jiangruyi.com/uview/swiper/swiper2.png"}]}),onLoad(){this.addRandomData()},onReachBottom(){this.loadStatus="loading",setTimeout((()=>{this.addRandomData(),this.loadStatus="loadmore"}),1e3)},methods:{addRandomData(){for(let t=0;t<10;t++){let t=r(0,this.list.length-1),e=JSON.parse(JSON.stringify(this.list[t]));e.id=u(),this.flowList.push(e)}},remove(t){this.$refs.uWaterfallRef.remove(t)},clear(){this.$refs.uWaterfallRef.clear()}}},[["render",function(l,r,u,w,v,_){const j=g(p("up-lazy-load"),t),x=o,D=g(p("up-icon"),f),V=g(p("up-waterfall"),y),R=g(p("up-loadmore"),L);return e(),i(x,{class:"wrap"},{default:s((()=>[a(V,{modelValue:v.flowList,"onUpdate:modelValue":r[0]||(r[0]=t=>v.flowList=t),ref:"uWaterfallRef"},{left:s((({leftList:t})=>[(e(!0),d(m,null,h(t,((t,l)=>(e(),i(x,{class:"demo-warter",key:l},{default:s((()=>[a(j,{threshold:"-450",height:"120","border-radius":"10",image:t.image,index:l},null,8,["image","index"]),a(x,{class:"demo-title"},{default:s((()=>[n(c(t.title),1)])),_:2},1024),a(x,{class:"demo-price"},{default:s((()=>[n(c(t.price)+"元",1)])),_:2},1024),a(x,{class:"demo-tag"},{default:s((()=>[a(x,{class:"demo-tag-owner"},{default:s((()=>[n("自营")])),_:1}),a(x,{class:"demo-tag-text"},{default:s((()=>[n("放心购")])),_:1})])),_:1}),a(x,{class:"demo-shop"},{default:s((()=>[n(c(t.shop),1)])),_:2},1024),a(x,{class:"u-close"},{default:s((()=>[a(D,{name:"close-circle-fill",color:"#fa3534",size:"16",onClick:e=>_.remove(t.id)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),right:s((({rightList:t})=>[(e(!0),d(m,null,h(t,((t,l)=>(e(),i(x,{class:"demo-warter",key:l},{default:s((()=>[a(j,{threshold:"-450",height:"120","border-radius":"10",image:t.image,index:l},null,8,["image","index"]),a(x,{class:"demo-title"},{default:s((()=>[n(c(t.title),1)])),_:2},1024),a(x,{class:"demo-price"},{default:s((()=>[n(c(t.price)+"元",1)])),_:2},1024),a(x,{class:"demo-tag"},{default:s((()=>[a(x,{class:"demo-tag-owner"},{default:s((()=>[n("自营")])),_:1}),a(x,{class:"demo-tag-text"},{default:s((()=>[n("放心购")])),_:1})])),_:1}),a(x,{class:"demo-shop"},{default:s((()=>[n(c(t.shop),1)])),_:2},1024),a(x,{class:"u-close"},{default:s((()=>[a(D,{name:"close-circle-fill",color:"#fa3534",size:"34",onClick:e=>_.remove(t.id)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modelValue"]),a(R,{"bg-color":"rgb(240, 240, 240)",status:v.loadStatus,onLoadmore:_.addRandomData},null,8,["status","onLoadmore"])])),_:1})}],["__scopeId","data-v-13c6eb16"]]);export{v as default};
