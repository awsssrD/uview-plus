import{_ as t}from"./u-icon.tupX-0wl.js";import{r as e,o as s,c as i,w as l,i as a,a as o,j as r,b as n,d as c,F as u,k as h,I as m,z as p,E as d,t as g,e as f}from"./index-Pv2Elt_A.js";import{r as b}from"./uni-app.es.dOUHyf1E.js";import{c as w}from"./classify.data.DNdyMZts.js";import{_ as T}from"./_plugin-vue_export-helper.BCo6x5W8.js";const _=T({data:()=>({scrollTop:0,oldScrollTop:0,current:0,menuHeight:0,menuItemHeight:0,itemId:"",tabbar:w,menuItemPos:[],arr:[],scrollRightTop:0,timer:null}),onLoad(){},onReady(){this.getMenuItemTop()},methods:{async swichMenu(t){0==this.arr.length&&await this.getMenuItemTop(),t!=this.current&&(this.scrollRightTop=this.oldScrollTop,this.$nextTick((function(){this.scrollRightTop=this.arr[t],this.current=t,this.leftMenuStatus(t)})))},getElRect(t,e){new Promise(((s,i)=>{uni.createSelectorQuery().in(this).select("."+t).fields({size:!0},(i=>{i?(this[e]=i.height,s()):setTimeout((()=>{this.getElRect(t)}),10)})).exec()}))},async observer(){this.tabbar.map(((t,e)=>{uni.createIntersectionObserver(this).relativeTo(".right-box",{top:0}).observe("#item"+e,(t=>{if(t.intersectionRatio>0){let e=t.id.substring(4);this.leftMenuStatus(e)}}))}))},async leftMenuStatus(t){this.current=t,0!=this.menuHeight&&0!=this.menuItemHeight||(await this.getElRect("menu-scroll-view","menuHeight"),await this.getElRect("u-tab-item","menuItemHeight")),this.scrollTop=t*this.menuItemHeight+this.menuItemHeight/2-this.menuHeight/2},getMenuItemTop(){new Promise((t=>{uni.createSelectorQuery().selectAll(".class-item").boundingClientRect((e=>{e.length?e.forEach((s=>{this.arr.push(s.top-e[0].top),t()})):setTimeout((()=>{this.getMenuItemTop()}),10)})).exec()}))},async rightScroll(t){this.oldScrollTop=t.detail.scrollTop,0==this.arr.length&&await this.getMenuItemTop(),this.timer||(this.menuHeight||await this.getElRect("menu-scroll-view","menuHeight"),setTimeout((()=>{this.timer=null;let e=t.detail.scrollTop+this.menuHeight/2;for(let t=0;t<this.arr.length;t++){let s=this.arr[t],i=this.arr[t+1];if(!i||e>=s&&e<i)return void this.leftMenuStatus(t)}}),10))}}},[["render",function(w,T,_,I,v,y){const S=b(e("up-icon"),t),H=h,R=a,x=m,M=f;return s(),i(R,{class:"u-wrap"},{default:l((()=>[o(R,{class:"u-search-box"},{default:l((()=>[o(R,{class:"u-search-inner"},{default:l((()=>[o(S,{name:"search",color:"#909399",size:28}),o(H,{class:"u-search-text"},{default:l((()=>[r("搜索")])),_:1})])),_:1})])),_:1}),o(R,{class:"u-menu-wrap"},{default:l((()=>[o(x,{"scroll-y":"","scroll-with-animation":"",class:"u-tab-view menu-scroll-view","scroll-top":v.scrollTop,"scroll-into-view":v.itemId},{default:l((()=>[(s(!0),n(u,null,c(v.tabbar,((t,e)=>(s(),i(R,{key:e,class:p(["u-tab-item",[v.current==e?"u-tab-item-active":""]]),onClick:d((t=>y.swichMenu(e)),["stop"])},{default:l((()=>[o(H,{class:"u-line-1"},{default:l((()=>[r(g(t.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["scroll-top","scroll-into-view"]),o(x,{"scroll-top":v.scrollRightTop,"scroll-y":"","scroll-with-animation":"",class:"right-box",onScroll:y.rightScroll},{default:l((()=>[o(R,{class:"page-view"},{default:l((()=>[(s(!0),n(u,null,c(v.tabbar,((t,e)=>(s(),i(R,{class:"class-item",id:"item"+e,key:e},{default:l((()=>[o(R,{class:"item-title"},{default:l((()=>[o(H,null,{default:l((()=>[r(g(t.name),1)])),_:2},1024)])),_:2},1024),o(R,{class:"item-container"},{default:l((()=>[(s(!0),n(u,null,c(t.foods,((t,e)=>(s(),i(R,{class:"thumb-box",key:e},{default:l((()=>[o(M,{class:"item-menu-image",src:t.icon,mode:""},null,8,["src"]),o(R,{class:"item-menu-name"},{default:l((()=>[r(g(t.name),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["id"])))),128))])),_:1})])),_:1},8,["scroll-top","onScroll"])])),_:1})])),_:1})}],["__scopeId","data-v-23f61477"]]);export{_ as default};
